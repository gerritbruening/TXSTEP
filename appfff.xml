<?xml version="1.0" encoding="UTF-8"?>
<script xmlns="http://www.xstep.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <variables>
        <variable type="execution-file" name="execute"
            >file:///C:/Users/Gerrit/txstep/ueb/txstep.tu</variable>
        <char-group name="pw">{#},.</char-group>
        <char-group name="pp">?-|</char-group>
        <string-group name="it">
            <member>{{/IT}}</member>
        </string-group>
        <string-group name="hr">
            <member>{{HR}}</member>
        </string-group>
        <string-group name="ko">
            <member>\{aa\}</member>
            <member>\{aa+\}</member>
            <member>\{aa-\}</member>
            <member>\{bb\}</member>
            <member>\{cc\}</member>
            <member>\{dd\}</member>
            <member>\{ee\}</member>
            <member>\{ff\}</member>
            <member>\{gg\}</member>
            <member>\{hh\}</member>
            <member>\{xx+\}</member>
            <member>\{xx!\}</member>
            <member>\{xx-\}</member>
            <member>\{yy\}</member>
            <member>\{yy-\}</member>
            <member>\{yy|ND1989|\}</member>
            <member>\{zz\}</member>
            <member>\{zz!\}</member>
        </string-group>
        <string-group name="ga">
            <member>+</member>
            <member>-</member>
            <member>+!</member>
        </string-group>
        <string-group name="ka">
            <exception>{{KA}}</exception>
            <member>?</member>
        </string-group>
        <string-group name="an">
            <exception>#.'</exception>
            <member>?</member>
        </string-group>
        <!-- sources -->
        <variable type="permanent-file" name="muo-z2a" format="tustep"
            >file:///C:/Users/Gerrit/txstep/txt/muo_z2a.tf</variable>
        <variable type="permanent-file" name="varianten" code="utf8"
            >file:///C:/Users/Gerrit/txstep/txt/MoE1_Varianten.txt</variable>
        <!-- outputs tf -->
        <variable type="permanent-file" name="muo-app" option="erase" format="tustep"
            >file:///C:/Users/Gerrit/txstep/txt/muo_app.tf</variable>
        <variable type="permanent-file" name="wf-app" option="erase" format="tustep"
            >file:///C:/Users/Gerrit/txstep/txt/wf_app.tf</variable>
        <variable type="permanent-file" name="wf-app-x" option="erase" format="tustep"
            >file:///C:/Users/Gerrit/txstep/txt/wf_app_x.tf</variable>
        <variable type="permanent-file" name="muo-app-x" option="erase" format="tustep"
            >file:///C:/Users/Gerrit/txstep/txt/muo_app_x.tf</variable>
        <!-- outputs txt -->
        <variable type="permanent-file" name="muo-app-txt" option="erase" code="utf8"
            >file:///C:/Users/Gerrit/txstep/txt/fff_app.txt</variable>
        <variable type="permanent-file" name="wf-app-txt" option="erase" code="utf8"
            >file:///C:/Users/Gerrit/txstep/txt/wf_app.txt</variable>
    </variables>
    <transform source="$muo-z2a" destination="$muo-app">
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <search-string>{{PW:</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
    </transform>
    <transform source="$muo-app" destination="$muo-app-x">
        <!-- preparatory clean-up -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>"Popup-Verknüpfung"{[}{00}{c:pw}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>"Popup-Verknüpfung"</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>PW:{[}AUSZEICHUNGEN{00}{c:pw}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{PS:"LESETEXT DRUCK"}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{/FD:Popup}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{IT-}}{{FT:Arial,SN}}{{PT:10}}{{FC:0,0,255}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{{IT}}{{FT}}{{PT}}{{FC}}</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>{[}{{IT+}}{]}{{PW:</search-string>
                            <replacement-string>{{IT}}</replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>{{IT}}{]}</search-string>
                            <replacement-string>{{/IT}}</replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>{{IT}}{|}{{EL}}{]}</search-string>
                            <replacement-string>{=2=}{{/IT}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{00}{s:hr}</search-string>
                            <replacement-string>{{HR}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- final part of app entry -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{{LT}}{|}*{|}{{EL}}{]}{0}{s:it}</search-string>
                            <replacement-string>{{KA}}{=2=}{{/KA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- 2 readings -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}{{PW:"HANDEXEMPLAR Variante Bleistift"}}{|}*{|}{{HR}}(auch Druckvariante Fris%/e){]}{{KA}}</search-string>
                            <replacement-string>{{HE}}{=2=}{{/HE}} {{RA}}{=2=}{{/RA}} </replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- 1 reading -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}{{PW:"Druckvariante Fris%/e"}}{|}{00}{s:ka}</search-string>
                            <replacement-string>{{RA}}{=2=}{{/RA}} </replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>{[}{{PW:"HANDEXEMPLAR Variante Bleistift"}}{|}{00}{s:ka}</search-string>
                            <replacement-string>{{HE}}{=2=}{{/HE}} </replacement-string>
                        </string-pair>
                        <string-pair>
                            <search-string>{[}{{PW:"Druckvariante Erstausgabe"}}{|}*{|}{{KA}}</search-string>
                            <replacement-string>{{EA}}{=2=}{{/EA}} {=3=}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table> </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!--<pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{{IT}}{{PW:"Druckvariante Erstausgabe"}}gesperrt{{HR}}Druckvariante Fris%/e: kursiv{{KA}}{|}*{|}{{/KA}}{{/IT}}</search-string>
                            <replacement-string>{{EA}}{{sp}}{=2=}{{/sp}}{{/EA}} {{RA}}{{it}}{=2=}{{/it}}{{RA}} {{KA}}{{it}}{=2=}{{/it}}{{/KA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>-->
    </transform>
    <transform source="$varianten" destination="$wf-app" mode="+">
        <pass>
            <examine-text>
                <select>
                    <text-contains>
                        <search-table>
                            <exception-string>\{GA+!: ...\}</exception-string>
                            <exception-string>\{GA-: ...\}</exception-string>
                            <exception-string>\{GA!!: ...\}</exception-string>
                            <search-string>\{\G\A</search-string>
                            <search-string>Nullvarianz</search-string>
                        </search-table>
                    </text-contains>
                </select>
            </examine-text>
        </pass>
    </transform>
    <transform source="$wf-app" destination="$wf-app-x">
        <!-- Zählung entfernen -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}{#}) </search-string>
                            <replacement-string/>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- Seite entfernen -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}\[Seite {#}\] </search-string>
                            <replacement-string/>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- KOMM -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{s:ko}</search-string>
                            <replacement-string>{{Textkonstitution Typ="{+1=}"/}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>Typ="{[}\{</search-string>
                            <replacement-string/>
                        </string-pair>
                        <string-pair>
                            <search-string>\}{]}"/}}</search-string>
                            <replacement-string/>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- GA -->
        <!-- GA kursiv -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{GA{0}{s:ga}: #.,{|}{00}{s:an}{|}#.'|kursiv|\}</search-string>
                            <replacement-string>{{GA}}{{it}}{=2=}{{/it}}{{/GA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- GA "..." |...| -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{GA{0}{s:ga}: #.,{|}{00}{s:an}{|}#.'{00} |{|}{00}{c:pp}{|}|\}</search-string>
                            <replacement-string>{{GA}}{=2=}{{note}}{=4=}{{/note}}{{/GA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- GA buggy case of "..." |...| -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{GA+!: #.,{|}*{|}#.'|{|}*{|}|\}</search-string>
                            <replacement-string>{{GA}}{=2=}{{note}}{=4=}{{/note}}{{/GA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- GA "..." -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{GA{0}{s:ga}{0}: #.,{|}*{|}#.'\}</search-string>
                            <replacement-string>{{GA}}{=2=}{{/GA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <!-- KA -->
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{KA: #.,{|}*{|}#.'|kursiv|\}</search-string>
                            <replacement-string>{{KA}}{{it}}{=2=}{{/it}}{{/KA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{KA: #.,{|}*{|}#.'|nicht kursiv|\}</search-string>
                            <replacement-string>{{KA}}{=2=}{{/KA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{KA: #.,{|}*{|}#.'\}</search-string>
                            <replacement-string>{{KA}}{=2=}{{/KA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{RA: #.,{|}*{|}#.'|kursiv|\}</search-string>
                            <replacement-string>{{RA}}{{it}}{=2=}{{/it}}{{/RA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{RA: #.,{|}*{|}#.'\}</search-string>
                            <replacement-string>{{RA}}{=2=}{{/RA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{HE: #.,{|}*{|}#.'\}</search-string>
                            <replacement-string>{{HE}}{=2=}{{/HE}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{EA: #.,{|}*{|}#.'|gesperrt|\}</search-string>
                            <replacement-string>{{EA}}{{sp}}{=2=}{{/sp}}{{/EA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>\{EA: #.,{|}*{|}#.'\}</search-string>
                            <replacement-string>{{EA}}{=2=}{{/EA}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}\{#.,{|}*{|}#.'|Nullvarianz{0}|\}{]}</search-string>
                            <replacement-string>{{ALLE}}{=2=}{{/ALLE}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
        <pass>
            <modify>
                <exchange>
                    <exchange-table>
                        <string-pair>
                            <search-string>{[}*{]}</search-string>
                            <replacement-string>{{app}} {=1=} {{/app}}</replacement-string>
                        </string-pair>
                    </exchange-table>
                </exchange>
            </modify>
        </pass>
    </transform>
    <transform source="$muo-app-x" destination="$muo-app-txt"/>
    <transform source="$wf-app-x" destination="$wf-app-txt"/>
</script>
